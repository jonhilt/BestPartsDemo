@page "/"
@using BestPartsDemo.Models
@rendermode InteractiveServer

<PageTitle>Contacts</PageTitle>

<div class="container mx-auto px-4 py-8">
    <div class="mb-8">
        <h1 class="text-4xl font-bold text-gray-800 mb-2">Contacts</h1>
        <p class="text-gray-600">Everyone you've ever met, all on one handy card wall!</p>
    </div>

    @if (_isLoading)
    {
        <LoadingSpinner Message="Loading contacts..."/>
    }
    else
    {
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            @foreach (var contact in _contacts)
            {
                <ContactCard Contact="@contact"/>
            }
        </div>
    }
</div>

@code {

    List<Contact>? _contacts;

    private bool _isLoading;

    protected override async Task OnInitializedAsync()
    {
        Console.WriteLine($"Contacts Length: {(RendererInfo.IsInteractive ? "interactive" : "prerender")}: {_contacts?.Count ?? 0}");
        
        if (_contacts == null)
        {
            Console.WriteLine("fetching contacts...");
            
            _isLoading = true;
            _contacts = await GetContacts();
            _isLoading = false;
        }
    }

    private async Task<List<Contact>> GetContacts()
    {
        await Task.Delay(500);

        return
        [
            new("Alice Johnson", "alice.johnson@techcorp.com", "+1 (555) 123-4567", "TechCorp Inc.", "Senior Developer"),
            new("Bob Smith", "bob.smith@innovate.io", "+1 (555) 234-5678", "Innovate.io", "Product Manager"),
            new("Carol Martinez", "carol.m@designstudio.com", "+1 (555) 345-6789", "Design Studio", "UX Designer"),
            new("David Chen", "david.chen@cloudservices.net", "+1 (555) 456-7890", "Cloud Services", "DevOps Engineer"),
            new("Emily Brown", "emily.brown@datainsights.com", "+1 (555) 567-8901", "Data Insights", "Data Scientist"),
            new("Frank Wilson", "frank.w@startuplab.xyz", "+1 (555) 678-9012", "Startup Lab", "CTO"),
            new("Grace Lee", "grace.lee@marketpro.com", "+1 (555) 789-0123", "MarketPro", "Marketing Director"),
            new("Henry Taylor", "henry.taylor@financeplus.com", "+1 (555) 890-1234", "FinancePlus", "Financial Analyst")
        ];
    }

}
@page "/"
@using BestPartsDemo.Models
@using BestPartsDemo.Services
@inject IContactService ContactService
@rendermode InteractiveServer

<PageTitle>Contacts</PageTitle>

<div class="mb-8">
    <h1 class="text-4xl font-bold text-gray-800 mb-2">Blazor CRM</h1>
    <p class="text-gray-600">Welcome, here are your most recent contactsâ€¦</p>
</div>

@if (_isLoading)
{
    <LoadingSpinner Message="Loading contacts..."/>
}
else
{
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        @foreach (var contact in Contacts?.Take(10) ?? [])
        {
            <ContactCard Contact="@contact"/>
        }
    </div>
}


@code {

    [PersistentState]
    public List<Contact>? Contacts { get; private set; }

    private bool _isLoading;

    protected override async Task OnInitializedAsync()
    {
        if (Contacts == null)
        {
            _isLoading = true;

            if (RendererInfo.IsInteractive)
            {
                await Task.Delay(500); // Simulate loading delay for demo purposes
            }

            Contacts = await ContactService.GetAllContactsAsync();
            _isLoading = false;
        }
    }

}